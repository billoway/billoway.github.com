---
title: "使用Bash脚本将build好的程序部署到iPhone上"
date: 2011-09-15 15:27
tags: ios
---

无IDP ,iphone需要越狱。具体的方法是先用scp命令将编译好的app复制到iPhone的Applications目录，然后用ssh服务连到iPhone上，使用ldid命令给app签注，再杀掉SpringBoard进程刷新界面。
每次部署时只需使用脚本，以iPhone的IP地址作为参数即可（iPhone上要求先安装SSH服务）。
<!-- more -->
1. 生成名为rsa的密匙文件。
`ssh-keygen -t rsa`

2. 在iPhone上建立.ssh目录。
`ssh root@iphoneipaddr 'mkdir -p .ssh'`

3. 将id_rsa.pub文件拷贝到iPhone的目录上，这样使用ssh和scp命令连接iPhone时就不再需要每次输入alpine密码了。 
` cat ~/.ssh/id_rsa.pub | ssh root@10.0.2.2 'cat >> .ssh/authorized_keys' `

4. 建立installApp.sh文件，增加执行权限
`chomd +x installApp.sh`

5. 在installApp.sh文件中输入以下内容
```
#!/bin/sh
apppath=~/Documents/iPhone-source/foo-Project/build/Release-iphoneos/foo.app
iphone="$1"
# login iphone to remove old files first
ssh -l "root" "$iphone" "rm -rf /Applications/foo.app"
# copy app files to iPhone machine
scp -r $apppath root@$iphone:/Applications
# login iphone to resign app and kill SpringBoard to force refresh
ssh -l "root" "$iphone" "cd /Applications/foo.app; ldid -s foo; killall 9 SpringBoard"
```

保存之后，你就可以以iPhone的IP地址为参数执行脚本 `./installApp.sh 192.168.X.X` 来将app部署到iPhone上了.